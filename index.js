!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("lodash/partial")):"function"==typeof define&&define.amd?define(["lodash/partial"],t):n.GoogleMapHelper=t(n.partial)}(this,function(n){"use strict";n=n&&n.hasOwnProperty("default")?n.default:n;var t=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(n[e]=r[e])}return n},r=function(n){var r;n&&(r=JSON.parse(n));var e,o,a,i,u,c=t({autozoom:!1,boundmap:!1,centermap:!1,draggable:!0,optimized:!1,mapTypeControl:!1,scrollwheel:!1,type:"ROADMAP",zoom:15,zoomControl:!0},r,(o=(e=r).pins,a=e.lng,i=e.lat,0===(u=Array.isArray(o)?o:[o]).length?{pins:u}:(console.log(u),u.length>1&&!a&&!i?{pins:u,boundmap:!0}:a&&i?{pins:u,lng:a,lat:i}:{pins:u,lng:u[0].lng,lat:u[0].lat}))),d={addType:function(n){var t=n||c.type;return c.mapTypeId=google.maps.MapTypeId[t],d},addCenter:function(n,t){var r=n||c.lat,e=t||c.lng;return c.center=new google.maps.LatLng(r,e),d},get:function(n){return c[n]},getAll:function(){return c},update:function(n){return c=t({},c,n),d}};return d};var e=function(n,r,e){return"undefined"!=typeof InfoBubble?function(n,r,e){var o=t({shadowStyle:0,padding:0,backgroundColor:"#55a440",borderRadius:0,arrowSize:2,borderWidth:0,borderColor:"#2c2c2c",disableAutoPan:!1,hideCloseButton:!0,arrowPosition:50,minHeight:220,backgroundClassName:"infowindow clearfix",arrowStyle:2,maps:n,content:r},e);return new InfoBubble(o)}(n,r,e):new google.maps.InfoWindow({content:r})};var o=function(n,t,r){var e=function(n,t){return function(r,e){var o=document.getElementById("pin-"+t);if(null===o)return null;google.maps.event.addDomListener(o,"click",function(t){t.preventDefault(),e.close(n,r)})}}(n,t);return function(t,o){google.maps.event.addListener(t,"click",function(){r.closeAllWindows(),o.open(n,t),"undefined"!=typeof InfoBubble&&(google.maps.event.trigger(n,"resize"),setTimeout(function(){e(t,o)},500))})}};var a=function(n){var t=void 0,r=void 0;return n?function(a,i){var u=function(n){var t=[];return{addMarkers:function(n){Array.isArray(n)?t=t.concat(n):t.push(n)},closeAllWindows:function(){t.forEach(function(t){t.hasOwnProperty("info")&&t.hasOwnProperty("marker")&&t.info.close(n,t.marker)})},getAll:function(){return t}}}(t=new a(n,i.getAll())),c=function(n,t){return function(r){var e=n(r);return t.addMarkers(e),e}}(function(n,t,r){return function(a){var i=a.lng,u=a.lat,c=new google.maps.Marker({position:new google.maps.LatLng(u,i),map:n});!function(n,t){(function(n){return"function"==typeof n.setIcon})(n)&&t.picture&&t.width&&t.height&&n.setIcon(t.picture,[t.width,t.height])}(c,a);var d=void 0;return a.infowindow&&(d=e(n,a.infowindow,r),o(n,a.id,t)(c,d)),{marker:c,info:d}}}(t,u),u);return r=function(n,t){return Array.isArray(n)?n.map(function(n){return t(n)}):[t(n)]}(i.get("pins"),c),{centerMap:function(n,t){return function(r){var e=new r;t.forEach(function(n){e.extend(n.marker.getPosition())}),n.fitBounds(e)}}(t,r),getMap:function(){return t},setPosition:function(n){var r=n({lat:i.get("lat"),lng:i.get("lng")});t.setCenter(r)},setZoom:function(n,t){return function(r){var e=r.addListener(n,"idle",function(){n.getZoom()!==t&&n.setZoom(t),r.removeListener(e)})}}(t,i.get("zoom"))}}:null};function i(n,t){var r=document.createElement("script");return r.id=t,r.type="text/javascript",r.src=n,r}var u=function(n){var t=[],r={addPlugins:function(n){return Array.isArray(n)?t=t.concat(n):"string"==typeof n&&t.push(n),r},load:function(){document.getElementById("gmapsScripts")||(document.body.appendChild(i(n,"gmapsScripts")),function(n){Array.isArray(n)&&n.length>0&&n.forEach(function(n,t){void 0!==n&&document.body.appendChild(i(n,"plugin"+t))})}(t))}};return r};Array.isArray||(Array.isArray=function(n){return"[object Array]"===Object.prototype.toString.call(n)});return function(t){var e=[].concat(function(n){if(Array.isArray(n)){for(var t=0,r=Array(n.length);t<n.length;t++)r[t]=n[t];return r}return Array.from(n)}(document.querySelectorAll("[data-map]")));if(0!==e.length){var o=function(n){var t=void 0,r=void 0,e=void 0;t="https://maps.google.com/maps/api/js?",t+="key="+n,r=[],e="uk";var o={addLibrary:function(n){return r.push(n),o},addRegion:function(n){return e=n,o},getPath:function(n){return r.length>0&&(t+="&libraries="+r.join(",")),t+="&async=2",t+="&region="+e,t+="&callback="+n}};return o}(t),i=e.map(function(n){return{options:r(n.dataset.map),map:a(n),id:n.id}}),c=function(n){return function(t){var r=n.find(function(n){var r=n.id;return t===r});if(r)return r.options}}(i),d=function(n){var t=Array.isArray(n)?n:[n];return function(n){var r=t.map(function(n){var t=n.map,r=n.options;r.addType(),r.addCenter();var e=t(google.maps.Map,r);return r.get("boundmap")&&e.centerMap(google.maps.LatLngBounds),r.get("autozoom")&&e.setZoom(google.maps.event),e.getMap()});"function"==typeof n&&n(r)}}(i);window.mapLoaded=d;var l={addCallback:function(t){return window.mapLoaded=n(d,t),l},addCenter:function(n,t,r){var e=c(n);return e?(e.update({lat:t,lng:r,centermap:!0}),l):l},addConfig:function(n,t){var r=c(n);return r?(r.update(t),l):l},addLibraries:function(n,t){var r=c(n);return r?(r.update({libraries:t}),l):l},addType:function(n,t){var r=c(n);return r?(r.update({type:t}),l):l},getMaps:function(){return i},load:function(){var n=i.reduce(function(n,t){var r=t.options;return n.concat(r.get("libraries"))},[]);u(o.getPath("mapLoaded")).addPlugins(n).load()},setBounds:function(n){var t=c(n);return t?(t.update({boundmap:!0}),l):l},setZoom:function(n,t){var r=c(n);return r?(r.update({zoom:t,autozoom:!0}),l):l}};return l}}});
//# sourceMappingURL=index.js.map
